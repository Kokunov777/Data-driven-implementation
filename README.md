erDiagram
    %% Справочники
    Город {
        int Id PK
        varchar Наименование
    }
    
    Улица {
        int Id PK
        varchar Наименование
        int Id_город FK
    }
    
    Банк {
        int Id PK
        varchar Наименование
        varchar БИК
    }
    
    Должность {
        int Id PK
        varchar Наименование
    }
    
    Подразделение {
        int Id PK
        varchar Наименование
    }
    
    Категория_товара {
        int Id PK
        varchar Наименование
    }
    
    Сорт {
        int Id PK
        varchar Наименование
        varchar Сезонность
    }
    
    %% Торговля
    Торговая_точка {
        int Id PK
        enum Тип
        varchar Наименование
        varchar График_работы
        varchar Номер_дома
        varchar Расположение
        int Id_город FK
        int Id_улица FK
    }
    
    Смена {
        int Id PK
        datetime Дата_начала
        datetime Дата_окончания
        int Id_Торговая_точка FK
    }
    
    Сотрудник {
        int Id PK
        varchar Фамилия
        varchar Имя
        varchar Отчество
        enum Пол
        date Дата_рождения
        int Трудовой_стаж
        varchar Код_ОКПДТР
        varchar Дом
        enum Статус
        int Id_Должность FK
        int Id_Подразделение FK
        int Id_город FK
        int Id_улица FK
    }
    
    %% Товары
    Товар {
        int Id PK
        varchar Наименование
        enum Тип
        decimal Цена
        int Срок_хранения
        int Диаметр
        int Возраст
        text Состав
        varchar Символическое_значение
        text Описание
        int Id_категория_товара FK
        int Id_сорт FK
    }
    
    %% Производство
    Оранжерея {
        int Id PK
        varchar Наименование
    }
    
    Теплица {
        int Id PK
        varchar Номер
        decimal Площадь
        int Id_Оранжерея FK
    }
    
    План_севооборота {
        int Id PK
        year Год
        date Дата_посадки
        date Дата_окончания
        enum Статус
        int Id_Теплица FK
        int Id_Товар FK
    }
    
    Работа {
        int Id PK
        varchar Наименование
        text Описание
    }
    
    Расписание_работ {
        int Id PK
        date Дата
        int Id_Теплица FK
        int Id_Работа FK
        int Id_Ответственный FK
    }
    
    %% Техника
    Производитель {
        int Id PK
        varchar Наименование
        varchar Код_ОК_028_2012
        varchar Аббревиатура
        varchar Номер_дома
        varchar Телефон_отдела_сбыта
        int Id_банк FK
        int Id_город FK
        int Id_улица FK
    }
    
    Техника {
        int Id PK
        varchar Наименование
        date Дата_выпуска
        date Дата_последнего_ремонта
        date Дата_очередного_ремонта
        enum Состояние
        int Id_Производитель FK
    }
    
    Запчасть {
        int Id PK
        varchar Наименование
        decimal Цена
        int Количество_на_складе
        int Id_Производитель FK
    }
    
    Дефектовочная_ведомость {
        int Id PK
        date Дата_составления
        text Описание_дефекта
        enum Статус
        int Id_Техника FK
    }
    
    Наряд_на_ремонт {
        int Id PK
        date Дата_выписки
        enum Статус
        int Id_Дефектовочная_ведомость FK
        int Id_Бригадир FK
    }
    
    Наряд_на_работу {
        int Id PK
        date Дата_выполнения
        time Время_работы
        decimal Норма
        int Id_Техника FK
        int Id_Сотрудник FK
    }
    
    %% Поставки
    Поставщик {
        int Id PK
        varchar Наименование
        varchar Код_органов
        varchar ИНН
        varchar БИН
        varchar Телефон_отдела_сбыта
        varchar Расчетный_счет
        varchar Корреспондентский_счет
        int Id_банк FK
        int Id_город FK
        int Id_улица FK
    }
    
    Договор_поставки {
        int Id PK
        varchar Номер
        date Дата_заключения
        varchar Срок_действия
        int Id_Поставщик FK
    }
    
    Поставка {
        int Id PK
        int Количество
        date Дата_поставки
        int Id_Товар FK
        int Id_Поставщик FK
    }
    
    Посадочный_материал {
        int Id PK
        varchar Тип
        date Дата_закупки
        int Количество
        int Id_Товар FK
        int Id_Поставщик FK
    }
    
    %% Учет и отчетность
    Отчет_о_продажах {
        int Id PK
        decimal Сумма_выручки
        date Дата_формирования_отчета
        int Количество
        int Id_Смена FK
    }
    
    Списание_продукции {
        int Id PK
        int Количество
        text Причина
        date Дата_списания
        int Id_Товар FK
    }
    
    Заявка_пополнения_ассортимента {
        int Id PK
        int Необходимое_количество
        date Дата_заявки
        enum Статус
        int Id_Торговая_точка FK
        int Id_Товар FK
    }
    
    %% Кадровый учет
    Запись_трудовой_книжки {
        int Id PK
        date Дата_приема
        date Дата_увольнения
        date Дата_перевода
        varchar Причина_прекращения_трудового_договора
        int Id_Сотрудник FK
    }
    
    Больничный_лист {
        int Id PK
        date Дата_начала
        date Дата_окончания
        varchar Номер
        varchar Диагноз
        int Id_Сотрудник FK
    }
    
    %% Связи M:M
    Смена_Сотрудник {
        int Id PK
        enum Роль
        int Id_Смена FK
        int Id_Сотрудник FK
    }

    %% Определение связей
    Улица ||--o{ Торговая_точка : "расположена_на"
    Город ||--o{ Торговая_точка : "расположена_в"
    Город ||--o{ Улица : "имеет"
    Торговая_точка ||--o{ Смена : "имеет"
    Смена ||--o{ Смена_Сотрудник : "участвует_в"
    Сотрудник ||--o{ Смена_Сотрудник : "работает_в"
    Должность ||--o{ Сотрудник : "занимает"
    Подразделение ||--o{ Сотрудник : "входит_в"
    Категория_товара ||--o{ Товар : "относится_к"
    Сорт ||--o{ Товар : "имеет"
    Оранжерея ||--o{ Теплица : "включает"
    Теплица ||--o{ План_севооборота : "планируется_в"
    Товар ||--o{ План_севооборота : "выращивается_по"
    Теплица ||--o{ Расписание_работ : "планируется_для"
    Работа ||--o{ Расписание_работ : "выполняется_по"
    Сотрудник ||--o{ Расписание_работ : "ответственный_за"
    Производитель ||--o{ Техника : "производит"
    Производитель ||--o{ Запчасть : "поставляет"
    Техника ||--o{ Дефектовочная_ведомость : "описывается_в"
    Дефектовочная_ведомость ||--|| Наряд_на_ремонт : "основание_для"
    Сотрудник ||--o{ Наряд_на_ремонт : "бригадир_в"
    Техника ||--o{ Наряд_на_работу : "используется_в"
    Сотрудник ||--o{ Наряд_на_работу : "работает_с"
    Банк ||--o{ Производитель : "обслуживает"
    Банк ||--o{ Поставщик : "обслуживает"
    Поставщик ||--o{ Договор_поставки : "заключает"
    Поставщик ||--o{ Поставка : "осуществляет"
    Товар ||--o{ Поставка : "поставляется_в"
    Поставщик ||--o{ Посадочный_материал : "поставляет"
    Товар ||--o{ Посадочный_материал : "используется_как"
    Смена ||--o{ Отчет_о_продажах : "отчитывается_по"
    Товар ||--o{ Списание_продукции : "списывается"
    Торговая_точка ||--o{ Заявка_пополнения_ассортимента : "формирует"
    Товар ||--o{ Заявка_пополнения_ассортимента : "запрашивается"
    Сотрудник ||--o{ Запись_трудовой_книжки : "имеет_запись"
    Сотрудник ||--o{ Больничный_лист : "имеет"
